<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="content="width=device-width, initial-scale=1.0, viewport-fit=cover"">
    <title>CIELITO LINDO - Menú Digital con Ruleta de Premios</title>
    <!-- Incluye Tailwind CSS para un diseño 100% responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Bebas+Neue&family=Merriweather:ital@1&display=swap" rel="stylesheet">
    <!-- Iconos de Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-red': '#E63946',    // Rojo Vibrante (Chile)
                        'brand-gold': '#FFC000',   // Dorado Brillante
                        'brand-green': '#5D9A58',  // Verde Lima/Bandera
                        'dark-bg': '#181818',      // Negro Profundo
                        'light-text': '#F5F5F5',   // Blanco Suave
                    },
                    fontFamily: {
                        'header': ['Bebas Neue', 'sans-serif'],
                        'body': ['Inter', 'sans-serif'],
                        'quote': ['Merriweather', 'serif'],
                    },
                    keyframes: {
                        'fadeInUp': {
                            '0%': { opacity: '0', transform: 'translateY(15px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        'float': {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-5px)' },
                        },
                        'modal-in': {
                            '0%': { opacity: '0', transform: 'scale(0.95)' },
                            '100%': { opacity: '1', transform: 'scale(1)' },
                        },
                    },
                    animation: {
                        'hero-appear': 'fadeInUp 1s ease-out',
                        'float-effect': 'float 3s ease-in-out infinite',
                        'modal-open': 'modal-in 0.3s ease-out',
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos generales y tipografía uniforme */
        body { 
            background-color: #0A0A0A; 
            color: var(--light-text); 
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
            font-size: 1rem; /* Base uniforme para todo el cuerpo */
        }

        /* Títulos principales */
        .title-font {
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 0.1em;
        }

        /* Hero Section */
        .hero-background {
            background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.8)), url('uploaded:image_dec9c6.jpg-b5a13fb1-becf-40b4-86f6-5d78d42789f6');
            background-size: cover;
            background-position: center;
        }

        /* Barra de Búsqueda */
        #search-input {
            font-size: 1rem; /* Uniforme */
        }
        
        /* Precios */
        .price-tag {
            background-color: #262626;
            color: #E63946;
            border: 1px solid #E63946;
            font-size: 1.1rem; /* Uniforme y legible */
            line-height: 1; 
        }
        
        /* Lista de proteínas */
        .proteins-list .label {
            font-size: 0.95rem; 
            font-weight: 700; 
        }
        .proteins-list .protein-text {
             font-size: 0.9rem; 
             color: #9ca3af; 
        }

        /* TAMAÑOS DE TEXTO UNIFORMES PARA LOS ITEMS DEL MENÚ */
        .item-name {
            font-size: 1.4rem; /* Título de plato (ligeramente más grande para destaque) */
            line-height: 1.2; 
            font-weight: 900; 
            color: #F5F5F5; 
        }
        
        /* Descripción del plato: Tamaño estándar (1rem) */
        .item-desc {
            font-size: 1rem; 
            line-height: 1.4;
            font-style: italic;
            color: #9ca3af; 
        }

        /* Contenedor de filtros con scroll horizontal */
        .horizontal-scroll {
            overflow-x: auto;
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .horizontal-scroll::-webkit-scrollbar {
            display: none; /* Chrome, Safari and Opera */
        }

        /* --- Estilos Ruleta --- */
        .roulette-wrapper {
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1); 
        }
        .indicator {
            position: absolute;
            top: 0; 
            left: 50%;
            transform: translateX(-50%) translateY(-10px); 
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 25px solid #ff4500; 
            z-index: 20;
        }
        #spinButton {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            transition: all 0.3s ease;
        }
        #spinButton:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }
        /* Asegurar que el contenedor de la ruleta sea un cuadrado para que la ruleta no se deforme */
        .ruleta-square-container {
             /* truco para hacer un div cuadrado basado en el ancho */
            padding-top: 100%; 
            position: relative;
        }
    </style>
</head>

<body>

    <script>
        // --- DATA DEL RESTAURANTE (MANTENIDA) ---
        const proteinsES = "Tinga, Chicharrón, Pastor, Lengua, Camarón, Cerdo Desmechado, Chorizo Vegano, Champiñón, Pollo, Chorizo";
        const proteinsEN = "Tinga, Pork Rind, Pastor, Tongue, Shrimp, Shredded Pork, Vegan Sausage, Mushroom, Chicken, Sausage";
        
        const content = {
            es: {
                proteinsLabel: "Proteínas a Elegir:",
                proteins: proteinsES,
                allProteinsList: proteinsES.split(', ').map(p => p.trim()),
                categories: {
                    starters: { label: "Entradas", icon: "fa-seedling" },
                    main: { label: "Platos Fuertes", icon: "fa-hotdog" },
                    fastFood: { label: "Comida Rápida", icon: "fa-burger" },
                    drinks: { label: "Bebidas", icon: "fa-mug-hot" }
                },
                menuItems: {
                    starters: [ 
                        { name: "ELOTES", desc: "Cubiertas de Doritos, mayonesa, queso y tajín.", price: "18000", customizable: false, category: "Entradas", imgUrl: 'uploaded:image_55b70d.jpg-8b4a9646-29f0-45a5-a605-f55aee275329' },
                        { name: "SOPA MEXICANA", desc: "Sopa de tomate, con trocitos de aguacate, pollo, queso, maíz, totopo y cilantro.", price: "15000", customizable: false, category: "Entradas", imgUrl: 'uploaded:image_df450c.jpg-71a49222-c77a-4e4c-99ba-60a3338e5869' },
                        { name: "TRIO DE TACOS", desc: "Tortilla de maíz artesanal acompañado de la carne de su elección con cebolla, cilantro y guacamole.", price: "23000", customizable: true, category: "Entradas", imgUrl: 'uploaded:image_df4566.jpg-954d874b-b76c-460d-86df-73562b5769ef' },
                        { name: "FLAUTAS AHOGADAS", desc: "Tortillas de maíz rellenas de pollo, sumergida en guacamole, crema agria y frijol. (3 und)", price: "20000", customizable: false, category: "Entradas", imgUrl: 'uploaded:image_df5105.jpg-cefef5cf-4dfc-4547-99b5-03859145e196' },
                    ],
                    main: [ 
                        { name: "BURRITO BÁSICO", desc: "Tortilla grande rellena de carne, arroz, frijoles, queso, aguacate, pepinillos y guacamole.", price: "28000", customizable: true, category: "Fuertes", imgUrl: 'uploaded:image_570c86.jpg-d7316e9f-d402-4a55-9c24-80c4da0e726f' },
                        { name: "BURRITO CLÁSICO", desc: "Tortilla grande, arroz, frijoles, queso, aguacate, pepinillos, carne de la selección, guacamole y ají de la casa.", price: "32000", customizable: true, category: "Fuertes", imgUrl: 'uploaded:image_570c86.jpg-d7316e9f-d402-4a55-9c24-80c4da0e726f' },
                        { name: "QUESADILLAS", desc: "Tortilla de harina y queso, carne de su elección, guacamole.", price: "20000", customizable: true, category: "Fuertes", imgUrl: 'uploaded:image_de7769.jpg-092f3ba2-49d7-4338-ba55-6a0e38f1d347' },
                        { name: "GRINGAS", desc: "Dos tortillas de harina, carne, piña asada, cebolla, cilantro, queso peruano y frijol.", price: "22000", customizable: true, category: "Fuertes", imgUrl: 'uploaded:image_de778d.jpg-b089eb52-fc4d-4864-ba56-6b0bb82eb5c4' },
                        { name: "BOWL MEXICANO", desc: "Arroz, frijol refrito, aguacate, pepinillos, carne de la selección, guacamole, crema agria y salsa roja.", price: "25000", customizable: true, category: "Fuertes", imgUrl: 'https://placehold.co/800x600/181818/FFC000?text=BOWL+MEXICANO' },
                        { name: "CHILAQUILES", desc: "Totopos de maíz bañados en salsa verde o roja, carne de su elección, crema agria y queso.", price: "28000", customizable: true, category: "Fuertes", imgUrl: 'https://placehold.co/800x600/181818/FFC000?text=CHILAQUILES' },
                    ],
                    fastFood: [ 
                        { name: "SALCHIPAPAS RÍO GRANDE", desc: "Salchipapas con pollo desmechado, queso fundido, cebolla, cilantro y pico de gallo.", price: "25000", customizable: false, category: "Comida Rápida", imgUrl: 'uploaded:image_dee0a2.jpg-d563bab4-9d6b-4a84-b080-3d9f5240845b' },
                        { name: "HAMBURGUESA CLÁSICA", desc: "Carne, queso, tomate, cebolla, lechuga y salsa de la casa.", price: "22000", customizable: false, category: "Comida Rápida", imgUrl: 'https://placehold.co/800x600/181818/E63946?text=HAMBURGUESA+CLASICA' },
                        { name: "HAMBURGUESA MEXICANA", desc: "Carne, queso, tomate, cebolla, lechuga, salsa de la casa, jalapeños, guacamole y totopos.", price: "25000", customizable: false, category: "Comida Rápida", imgUrl: 'https://placehold.co/800x600/181818/E63946?text=HAMBURGUESA+MEXICANA' },
                    ],
                    drinks: [ 
                        { name: "CHAMOYADA DE MANGO", desc: "Nuestra bebida refrescante y picantita.", price: "14000", customizable: false, category: "Bebidas", imgUrl: 'uploaded:image_df45a7.jpg-2e8a4e6e-6c95-4681-9f1e-90d1d2b60d87' },
                        { name: "LIMONADAS", desc: "Natural, Coco, Hierbabuena, Cereza.", price: "12000", customizable: false, category: "Bebidas", imgUrl: 'https://placehold.co/800x600/181818/5D9A58?text=LIMONADAS' },
                        { name: "GASEOSA PERSONAL", desc: "Coca Cola, Quatro, Sprite.", price: "6000", customizable: false, category: "Bebidas", imgUrl: 'https://placehold.co/800x600/181818/5D9A58?text=GASEOSA' },
                    ],
                }
            },
            en: {
                proteinsLabel: "Available Proteins:",
                proteins: proteinsEN,
                allProteinsList: proteinsEN.split(', ').map(p => p.trim()),
                categories: {
                    starters: { label: "Starters", icon: "fa-seedling" },
                    main: { label: "Main Dishes", icon: "fa-hotdog" },
                    fastFood: { label: "Fast Food", icon: "fa-burger" },
                    drinks: { label: "Drinks", icon: "fa-mug-hot" }
                },
                menuItems: {
                     starters: [ 
                        { name: "ELOTES", desc: "Covered with Doritos, mayonnaise, cheese, and tajín.", price: "18000", customizable: false, category: "Starters", imgUrl: 'uploaded:image_55b70d.jpg-8b4a9646-29f0-45a5-a605-f55aee275329' },
                        { name: "MEXICAN SOUP", desc: "Tomato soup with avocado chunks, chicken, cheese, corn, totopo, and cilantro.", price: "15000", customizable: false, category: "Starters", imgUrl: 'uploaded:image_df450c.jpg-71a49222-c77a-4e4c-99ba-60a3338e5869' },
                        { name: "TACO TRIO", desc: "Artisanal corn tortilla with meat of your choice, onion, cilantro, and guacamole.", price: "23000", customizable: true, category: "Starters", imgUrl: 'uploaded:image_df4566.jpg-954d874b-b76c-460d-86df-73562b5769ef' },
                        { name: "DROWNED FLAUTAS", desc: "Corn tortillas filled with shredded chicken, submerged in guacamole, sour cream and beans. (3 units)", price: "20000", customizable: false, category: "Starters", imgUrl: 'uploaded:image_df5105.jpg-cefef5cf-4dfc-4547-99b5-03859145e196' },
                    ],
                    main: [ 
                        { name: "BASIC BURRITO", desc: "Large tortilla filled with meat, rice, beans, cheese, avocado, pickles, and guacamole.", price: "28000", customizable: true, category: "Main Dishes", imgUrl: 'uploaded:image_570c86.jpg-d7316e9f-d402-4a55-9c24-80c4da0e726f' },
                        { name: "CLASSIC BURRITO", desc: "Large tortilla, rice, beans, cheese, avocado, pickles, meat of choice, guacamole, and house chili.", price: "32000", customizable: true, category: "Main Dishes", imgUrl: 'uploaded:image_570c86.jpg-d7316e9f-d402-4a55-9c24-80c4da0e726f' },
                        { name: "QUESADILLAS", desc: "Flour tortilla and cheese, meat of your choice, guacamole.", price: "20000", customizable: true, category: "Main Dishes", imgUrl: 'uploaded:image_de7769.jpg-092f3ba2-49d7-4338-ba55-6a0e38f1d347' },
                        { name: "GRINGAS", desc: "Two flour tortillas, meat, grilled pineapple, onion, cilantro, Peruvian cheese, and beans.", price: "22000", customizable: true, category: "Main Dishes", imgUrl: 'uploaded:image_de778d.jpg-b089eb52-fc4d-4864-ba56-6b0bb82eb5c4' },
                        { name: "MEXICAN BOWL", desc: "Rice, refried beans, avocado, pickles, meat of choice, guacamole, sour cream, and red sauce.", price: "25000", customizable: true, category: "Main Dishes", imgUrl: 'https://placehold.co/800x600/181818/FFC000?text=MEXICAN+BOWL' },
                        { name: "CHILAQUILES", desc: "Corn chips bathed in green or red sauce, meat of your choice, sour cream, and cheese.", price: "28000", customizable: true, category: "Main Dishes", imgUrl: 'https://placehold.co/800x600/181818/FFC000?text=CHILAQUILES' },
                    ],
                    fastFood: [ 
                        { name: "RIO GRANDE SALCHIPAPAS", desc: "Salchipapas with shredded chicken, melted cheese, onion, cilantro, and pico de gallo.", price: "25000", customizable: false, category: "Fast Food", imgUrl: 'uploaded:image_dee0a2.jpg-d563bab4-9d6b-4a84-b080-3d9f5240845b' },
                        { name: "CLASSIC BURGER", desc: "Meat, cheese, tomato, onion, lettuce, and house sauce.", price: "22000", customizable: false, category: "Fast Food", imgUrl: 'https://placehold.co/800x600/181818/E63946?text=CLASSIC+BURGER' },
                        { name: "MEXICAN BURGER", desc: "Meat, cheese, tomato, onion, lettuce, house sauce, jalapeños, guacamole, and totopos.", price: "25000", customizable: false, category: "Fast Food", imgUrl: 'https://placehold.co/800x600/181818/E63946?text=MEXICAN+BURGER' },
                    ],
                    drinks: [ 
                        { name: "MANGO CHAMOYADA", desc: "Our refreshing and spicy drink.", price: "14000", customizable: false, category: "Drinks", imgUrl: 'uploaded:image_df45a7.jpg-2e8a4e6e-6c95-4681-9f1e-90d1d2b60d87' },
                        { name: "LIMONADAS", desc: "Natural, Coco, Hierbabuena, Cereza.", price: "12000", customizable: false, category: "Drinks", imgUrl: 'https://placehold.co/800x600/181818/5D9A58?text=LEMONADES' },
                        { name: "GASEOSA PERSONAL", desc: "Coca Cola, Quatro, Sprite.", price: "6000", customizable: false, category: "Drinks", imgUrl: 'https://placehold.co/800x600/181818/5D9A58?text=SODA' },
                    ],
                }
            }
        };
        
        // --- PREMIOS DE LA RULETA (NUEVA LÓGICA ECONÓMICA) ---
        const prizes = [
            { text: 'Agua Fresca Gratis', color: '#5D9A58' },      // Verde (Bebida Económica)
            { text: 'Entremés de Totopos', color: '#FFC000' },    // Dorado (Entremés Económico)
            { text: '10% de Descuento', color: '#E63946' },      // Rojo (Descuento)
            { text: 'Mejor Suerte', color: '#4299E1' },           // Azul (Sin premio)
            { text: '2x1 en Cócteles', color: '#F687B3' },        // Rosado (Promoción Coctelería)
            { text: 'Postre de la Casa', color: '#9F7AEA' },       // Púrpura (Postre Económico)
            { text: 'Entremés de Totopos', color: '#F6AD55' },    // Naranja (Entremés repetido)
            { text: 'Agua Fresca Gratis', color: '#68D391' }       // Verde claro (Bebida repetida)
        ];

        let currentLang = 'es'; 
        let currentFilter = 'all'; 

        // --- VARIABLES DE RULETA ---
        const numSegments = prizes.length;
        const arc = (2 * Math.PI) / numSegments;
        let rotation = 0;
        let isSpinning = false;
        
        // --- RULETA JAVASCRIPT ---
        
        function drawRoulette() {
            const canvas = document.getElementById('rouletteCanvas');
            const ctx = canvas.getContext('2d');
            const radius = canvas.width / 2;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(radius, radius);
            ctx.rotate(rotation);

            for (let i = 0; i < numSegments; i++) {
                const angle = i * arc;
                const prize = prizes[i];

                // Dibujar segmento
                ctx.beginPath();
                ctx.fillStyle = prize.color;
                ctx.moveTo(0, 0);
                ctx.arc(0, 0, radius, angle, angle + arc);
                ctx.fill();

                // Dibujar borde
                ctx.strokeStyle = '#0A0A0A';
                ctx.lineWidth = 4;
                ctx.stroke();

                // Dibujar texto del premio
                ctx.save();
                ctx.rotate(angle + arc / 2);
                ctx.textAlign = 'right';
                ctx.fillStyle = (prize.text.includes('Suerte')) ? '#0A0A0A' : '#F5F5F5'; 
                ctx.font = 'bold 14px Inter, sans-serif'; // Fuente pequeña para que quepa
                
                // Dividir el texto largo
                const lines = prize.text.split(' ');
                const textLines = lines.length > 2 ? [lines[0] + ' ' + lines[1], lines.slice(2).join(' ')] : [prize.text];

                textLines.forEach((line, index) => {
                    ctx.fillText(line.toUpperCase(), radius * 0.9, -10 + index * 18);
                });
                
                ctx.restore();
            }

            // Dibujar círculo central
            ctx.beginPath();
            ctx.fillStyle = '#0A0A0A';
            ctx.arc(0, 0, radius * 0.15, 0, 2 * Math.PI);
            ctx.fill();
            ctx.strokeStyle = '#F5F5F5'; 
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.restore();
        }

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;
            const spinButton = document.getElementById('spinButton');
            spinButton.disabled = true;
            
            // 1. Elegir un segmento aleatorio
            const randomStopSegment = Math.floor(Math.random() * numSegments);
            const randomOffset = Math.random() * (arc * 0.8) - (arc * 0.4); // Offset para que no caiga justo en la línea
            const targetAngle = randomStopSegment * arc + randomOffset;
            
            // 2. Calcular rotación total (mínimo 5 vueltas)
            // El indicador está arriba (0 grados). El ángulo debe apuntar a 270 grados (90 grados de giro).
            const totalRotation = 5 * 360 + (360 - (targetAngle * (180 / Math.PI)) - 90); 
            
            // Aplicar rotación con CSS transition
            const canvas = document.getElementById('rouletteCanvas');
            canvas.style.transition = 'transform 5s cubic-bezier(0.25, 0.1, 0.25, 1)';
            canvas.style.transform = `rotate(${totalRotation}deg)`;

            // Mostrar estado de carga
            const messageElement = document.getElementById('spin-message');
            messageElement.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i> ${currentLang === 'es' ? 'Girando la suerte...' : 'Spinning the luck...'}`;
            messageElement.classList.remove('text-brand-green', 'text-brand-red');
            messageElement.classList.add('text-brand-gold');
            
            // 3. Determinar el ganador después de que termine la animación
            setTimeout(() => {
                isSpinning = false;
                spinButton.disabled = false;
                
                // Calcular el índice ganador
                let finalDegrees = totalRotation % 360; 
                finalDegrees = (finalDegrees < 0) ? finalDegrees + 360 : finalDegrees;
                
                // Rotación del canvas (0° arriba). El indicador está arriba.
                // Necesitamos el ángulo inverso para saber qué segmento apunta hacia arriba.
                let degreesPerSegment = 360 / numSegments;
                let segmentIndex = Math.floor(finalDegrees / degreesPerSegment);
                
                // Ajuste para el orden del array
                segmentIndex = numSegments - 1 - segmentIndex;
                if (segmentIndex < 0) segmentIndex = 0;

                const winner = prizes[segmentIndex];
                
                // Mostrar modal de resultado
                document.getElementById('prizeResult').textContent = winner.text;
                document.getElementById('resultTitle').textContent = (winner.text.includes('Suerte')) 
                    ? (currentLang === 'es' ? '¡Mala Suerte! :(' : 'Bad Luck! :(') 
                    : (currentLang === 'es' ? '¡Felicidades! Ganaste:' : 'Congratulations! You won:');
                
                document.getElementById('resultTitle').classList.toggle('text-red-500', winner.text.includes('Suerte'));
                document.getElementById('resultTitle').classList.toggle('text-brand-green', !winner.text.includes('Suerte'));

                toggleModal('modalResult', true);

                messageElement.innerHTML = currentLang === 'es' ? '¡Gira de Nuevo!' : 'Spin Again!';
                messageElement.classList.remove('text-brand-gold');
            }, 5000);
        }

        // --- FUNCIONES COMUNES Y DE MENÚ (MANTENIDAS) ---

        function formatCOP(price) {
            return new Intl.NumberFormat('es-CO', { 
                style: 'currency', 
                currency: 'COP', 
                minimumFractionDigits: 0 
            }).format(price);
        }

        function getAllMenuItems(lang) {
            const items = [];
            const menuData = content[lang].menuItems;
            for (const category in menuData) {
                items.push(...menuData[category].map(item => ({ ...item, section: category })));
            }
            return items;
        }

        function renderMenuItem(item, lang) {
            const proteinsList = content[lang].proteins;
            const proteinsLabel = content[lang].proteinsLabel;
            const priceCOP = formatCOP(item.price);
            
            const proteinsHtml = item.customizable ? `
                <div class="proteins-list bg-dark-bg/50 p-3 rounded-md transition duration-300 mt-2">
                    <p class="label font-semibold text-brand-gold">${proteinsLabel}</p>
                    <p class="protein-text">${proteinsList}</p>
                </div>
            ` : '';

            return `
                <div class="menu-item-card py-4 border-b border-gray-700/50 transition duration-300 hover:bg-dark-bg/30 px-2 rounded-lg cursor-pointer" 
                     data-name="${item.name.toLowerCase()}" 
                     data-desc="${item.desc.toLowerCase()}"
                     onclick="openImageModal('${item.name}', '${item.desc.replace(/'/g, "\\'")}', '${item.imgUrl}')">
                    
                    <div class="flex justify-between items-start">
                        <div class="mr-4">
                            <p class="item-name mb-1">${item.name}</p>
                            <p class="item-desc">${item.desc}</p>
                        </div>
                        <span class="price-tag px-4 py-2 rounded-full flex-shrink-0 ml-2">${priceCOP}</span>
                    </div>
                    ${proteinsHtml}
                </div>
            `;
        }
        
        function filterMenuByCategory(categoryKey) {
            currentFilter = categoryKey;
            const allItems = getAllMenuItems(currentLang);
            const menuContent = document.getElementById('menu-content');
            
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active', 'bg-brand-red'));
            const filterButton = document.getElementById(`filter-${categoryKey}`);
            if (filterButton) {
                filterButton.classList.add('active', 'bg-brand-red');
            } else if (categoryKey === 'all') {
                document.getElementById('filter-all').classList.add('active', 'bg-brand-red');
            }

            const filteredItems = allItems.filter(item => 
                categoryKey === 'all' || item.section === categoryKey
            );

            const resultsHtml = filteredItems.map(item => renderMenuItem(item, currentLang)).join('');
            menuContent.innerHTML = resultsHtml;

            document.getElementById('search-input').value = '';
            document.getElementById('search-results').classList.add('hidden');
            document.getElementById('menu').classList.remove('hidden');

            document.getElementById('menu').scrollIntoView({ behavior: 'smooth' });
        }
        
        function filterMenuBySearch() {
            const query = document.getElementById('search-input').value.toLowerCase().trim();
            const searchResultsSection = document.getElementById('search-results');
            const resultsContainer = document.getElementById('results-container');
            const noResultsMessage = document.getElementById('no-results');
            const menuSection = document.getElementById('menu');
            
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active', 'bg-brand-red'));
            
            if (query.length === 0) {
                searchResultsSection.classList.add('hidden');
                menuSection.classList.remove('hidden');
                filterMenuByCategory(currentFilter); 
                return; 
            }

            menuSection.classList.add('hidden');
            searchResultsSection.classList.remove('hidden');
            
            const allItems = getAllMenuItems(currentLang);
            const proteinsList = content[currentLang].allProteinsList;

            const filteredItems = allItems.filter(item => {
                const nameMatch = item.name.toLowerCase().includes(query);
                const descMatch = item.desc.toLowerCase().includes(query);
                const categoryMatch = item.category.toLowerCase().includes(query);
                const proteinMatch = item.customizable && proteinsList.some(p => p.toLowerCase().includes(query));

                return nameMatch || descMatch || categoryMatch || proteinMatch;
            });

            if (filteredItems.length > 0) {
                const resultsHtml = filteredItems.map(item => renderMenuItem(item, currentLang)).join('');
                resultsContainer.innerHTML = resultsHtml;
                noResultsMessage.classList.add('hidden');
            } else {
                resultsContainer.innerHTML = '';
                noResultsMessage.classList.remove('hidden');
            }
        }

        // --- FUNCIONES DE MODAL ---

        function toggleModal(modalId, show) {
            const modal = document.getElementById(modalId);
            const content = document.getElementById(modalId + 'Content');

            if (show) {
                modal.classList.remove('hidden');
                modal.classList.add('flex');
                setTimeout(() => {
                    content.classList.remove('opacity-0', 'scale-95');
                    content.classList.add('animate-modal-open');
                }, 10);
            } else {
                content.classList.add('opacity-0', 'scale-95');
                content.classList.remove('animate-modal-open');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }, 300); // Esperar la transición antes de ocultar
            }
        }
        
        function openImageModal(name, desc, imgUrl) {
            const modal = document.getElementById('image-modal');
            document.getElementById('modal-image').src = imgUrl;
            document.getElementById('modal-title').textContent = name;
            document.getElementById('modal-description').textContent = desc;
            
            modal.classList.remove('hidden');
            modal.querySelector('.modal-content').classList.add('animate-modal-open');
        }

        function closeImageModal() {
            const modal = document.getElementById('image-modal');
            modal.classList.add('hidden');
            modal.querySelector('.modal-content').classList.remove('animate-modal-open');
        }


        // --- FUNCIONES DE INICIALIZACIÓN ---

        function setLanguage(lang) {
            currentLang = lang;
            
            // 1. Dibujar la ruleta (los premios están fijos en español para el contexto del problema)
            drawRoulette();

            // 2. Traducir elementos con data-es/data-en
            document.querySelectorAll('[data-es]').forEach(el => {
                const text = el.getAttribute(`data-${lang}`);
                if (text) {
                    el.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                }
            });

            // 2.1 Traducir placeholder
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.placeholder = searchInput.getAttribute(`data-${lang}-placeholder`);
            }
            
            // 3. Renderizar y traducir botones de filtro
            renderFilterButtons(lang);
            
            // 4. Re-aplicar filtro actual con el nuevo idioma
            if (document.getElementById('search-input').value.trim().length > 0) {
                 filterMenuBySearch();
            } else {
                 filterMenuByCategory(currentFilter);
            }

            // 5. Actualizar botón de idioma
            const toggleButton = document.getElementById('lang-toggle');
            toggleButton.textContent = lang === 'es' ? 'EN' : 'ES';
            document.documentElement.lang = lang; 
        }

        function renderFilterButtons(lang) {
            const categories = content[lang].categories;
            const container = document.getElementById('filter-buttons-container');
            let buttonsHtml = '';

            // Botón 'Todos'
            const allLabel = lang === 'es' ? 'TODO' : 'ALL';
            buttonsHtml += `
                <button id="filter-all" onclick="filterMenuByCategory('all')" 
                        class="filter-btn bg-gray-700 text-light-text font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-gray-600 transition text-sm flex-shrink-0">
                    <i class="fas fa-list mr-1"></i> ${allLabel}
                </button>
            `;

            // Botones de Categorías
            for (const key in categories) {
                const cat = categories[key];
                buttonsHtml += `
                    <button id="filter-${key}" onclick="filterMenuByCategory('${key}')" 
                            class="filter-btn bg-gray-700 text-light-text font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-gray-600 transition text-sm flex-shrink-0">
                        <i class="fas ${cat.icon} mr-1"></i> ${cat.label}
                    </button>
                `;
            }

            container.innerHTML = buttonsHtml;
            const currentFilterButton = document.getElementById(`filter-${currentFilter}`);
            if(currentFilterButton) {
                currentFilterButton.classList.add('active', 'bg-brand-red');
            } else {
                document.getElementById('filter-all').classList.add('active', 'bg-brand-red');
            }
        }


        // Inicialización
        document.addEventListener('DOMContentLoaded', () => {
            // Establecer el tamaño del canvas (Cuadrado para móvil y desktop)
            const canvas = document.getElementById('rouletteCanvas');
            const containerWidth = document.getElementById('wheel-container').clientWidth;
            // Usamos un tamaño que sea el 90% del contenedor, máximo 350px
            const wheelSize = Math.min(containerWidth * 0.9, 350); 
            canvas.width = wheelSize;
            canvas.height = wheelSize;

            setLanguage('es'); 
            
            document.getElementById('lang-toggle').addEventListener('click', () => {
                setLanguage(currentLang === 'es' ? 'en' : 'es');
                document.getElementById('spin-message').innerHTML = currentLang === 'es' ? '¡Gira y gana un premio por tu consumo!' : 'Spin and win a prize for your order!';
            });

            document.getElementById('spinButton').addEventListener('click', spinWheel);
            document.getElementById('search-input').addEventListener('input', filterMenuBySearch);
        });
    </script>
    
    <!-- WhatsApp Flotante -->
    <a href="https://wa.me/message/KNZ4SJGC4PUPJ" target="_blank" class="whatsapp-float fixed bottom-6 right-6 p-3 rounded-full shadow-lg z-50 transition duration-300 animate-float-effect bg-brand-green/90 hover:bg-brand-green">
        <i class="fab fa-whatsapp text-2xl text-white"></i>
    </a>

    <!-- 1. Encabezado Fijo y Logo -->
    <header class="sticky top-0 z-50 bg-dark-bg/95 backdrop-blur-sm shadow-xl border-b border-brand-red">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center h-16">
            <!-- Logo CIELITO LINDO con icono -->
            <div class="flex items-center space-x-2">
                <img src="uploaded:image_df3e40.png-c8ee46d9-b29c-46ea-a300-6f30e6cf150d" alt="Logo Cielito Lindo" class="h-8 w-8 rounded-full border-2 border-brand-gold shadow-md">
                <span class="text-xl md:text-2xl font-black title-font text-brand-gold">CIELITO LINDO</span>
            </div>
            
            <!-- Botón de Idioma -->
            <button id="lang-toggle" class="bg-brand-red text-light-text font-black py-1.5 px-3 rounded-full text-sm shadow-lg hover:bg-red-700 transition duration-200 transform hover:scale-105">
                EN
            </button>
        </div>
    </header>

    <main class="min-h-screen">
        
        <!-- 2. Sección Principal (Hero) - Organizada y con Título Único -->
        <section id="inicio" class="hero-background py-12 md:py-16 px-4 text-center">
            <div class="max-w-xl mx-auto animate-hero-appear">
                <h1 class="text-3xl md:text-5xl font-black text-brand-gold leading-snug mb-3 title-font" data-es="¡FIESTA Y SABOR SIN LÍMITES!" data-en="FIESTA AND UNLIMITED FLAVOR!">
                    ¡FIESTA Y SABOR SIN LÍMITES!
                </h1>
                <p class="text-lg text-light-text/80 mb-6 font-quote italic" data-es="El menú que te hará decir '¡Ay, qué lindo es comer en México!'" data-en="The menu that will make you say 'Oh, how beautiful it is to eat in Mexico!'">
                    El menú que te hará decir "¡Ay, qué lindo es comer en México!".
                </p>
                <!-- Llamada a la acción principal -->
                <a href="#menu" class="cta-button inline-block px-6 py-2 bg-brand-gold text-dark-bg font-extrabold text-base rounded-full shadow-xl hover:bg-yellow-500 transition">
                    <span data-es="VER EL MENÚ AHORA" data-en="VIEW MENU NOW">VER EL MENÚ AHORA</span>
                </a>
            </div>
        </section>

        <!-- 3. Barra de Navegación (STICKY) para Búsqueda y Filtros -->
        <section class="sticky top-16 z-40 bg-dark-bg p-4 shadow-2xl border-b border-brand-gold/50">
            <div class="max-w-4xl mx-auto space-y-3">
                
                <!-- Búsqueda General -->
                <div class="relative">
                    <input type="text" id="search-input" 
                           class="w-full py-2 pl-12 pr-3 rounded-xl bg-gray-800 text-light-text focus:outline-none focus:ring-2 focus:ring-brand-gold"
                           placeholder="Buscar un plato, bebida o proteína (Tinga, Pastor...)"
                           data-es-placeholder="Buscar un plato, bebida o proteína (Tinga, Pastor...)"
                           data-en-placeholder="Search for a dish, drink, or protein (Tinga, Pastor...)">
                    <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-brand-gold text-lg"></i>
                </div>

                <!-- Filtros de Categoría (SCROLL HORIZONTAL) -->
                <div id="filter-buttons-container" class="horizontal-scroll flex space-x-2 pb-1">
                    <!-- Los botones de filtro se renderizan aquí por JS -->
                </div>
            </div>
        </section>

        <!-- 4. Sección de Resultados de Búsqueda (Oculta al buscar) -->
        <section id="search-results" class="py-8 px-4 hidden">
            <div class="max-w-4xl mx-auto">
                <h2 class="section-title text-3xl font-bold title-font text-brand-red mb-5" data-es="Resultados de Búsqueda" data-en="Search Results">Resultados de Búsqueda</h2>
                <div id="results-container" class="space-y-2 bg-[#1f1f1f] p-4 rounded-xl">
                    <!-- Los resultados de la búsqueda se renderizarán aquí -->
                </div>
                <p id="no-results" class="text-center text-lg text-gray-400 mt-6" data-es="¡Oops! No encontramos lo que buscas. Intenta con otra palabra." data-en="Oops! We couldn't find what you're looking for. Try another word.">
                    ¡Oops! No encontramos lo que buscas. Intenta con otra palabra.
                </p>
            </div>
        </section>


        <!-- 5. Sección de Menú Filtrado (Principal) -->
        <section id="menu" class="py-8 px-4 bg-dark-bg">
            <div class="max-w-4xl mx-auto menu-container">
                
                <h2 class="section-title text-3xl font-black title-font text-brand-green text-center mb-6 border-b-4 border-brand-gold pb-2" data-es="MENÚ - EXPLOSIÓN DE SABOR" data-en="MENU - FLAVOR EXPLOSION">MENÚ - EXPLOSIÓN DE SABOR</h2>

                <!-- Contenedor Único para el Menú Filtrado -->
                <div id="menu-content" class="space-y-2 bg-[#1f1f1f] p-4 rounded-xl shadow-inner border-t-4 border-brand-red">
                    <!-- El menú filtrado se renderiza aquí por JS -->
                </div>

            </div>
        </section>

        <!-- 6. RUEDA DE LA SUERTE - PREMIO POR CONSUMO -->
        <section id="ruleta" class="py-12 px-4 bg-[#121212] border-y-4 border-brand-red">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-3xl md:text-4xl font-black title-font text-brand-gold mb-3" data-es="PREMIO POR CONSUMO" data-en="PRIZE PER ORDER">PREMIO POR CONSUMO</h2>
                <p class="text-base text-light-text/80 mb-6" data-es="¡Gira y gana un premio adicional por tu orden!" data-en="Spin and win an extra prize for your order!"></p>

                <!-- Contenedor de la Ruleta -->
                <div id="wheel-container" class="relative mx-auto max-w-xs md:max-w-sm">
                    <div class="ruleta-square-container">
                        <div class="absolute inset-0 flex justify-center items-center">
                            <!-- Pin/Flecha indicadora -->
                            <div class="indicator"></div> 
                            <!-- Canvas para la Ruleta -->
                            <canvas id="rouletteCanvas" class="roulette-wrapper rounded-full border-4 border-brand-gold shadow-2xl absolute top-0 left-0" width="350" height="350"></canvas>
                            
                            <button id="spinButton" class="px-6 py-3 bg-brand-red text-light-text font-extrabold text-lg rounded-full shadow-lg ring-4 ring-brand-gold focus:outline-none hover:bg-red-700">
                                <span data-es="¡GIRAR!" data-en="SPIN!">¡GIRAR!</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Enlace a Términos y Condiciones -->
                <div class="text-center my-4">
                    <button onclick="toggleModal('modalTerms', true)" class="text-sm text-gray-400 hover:text-brand-gold transition duration-150 underline" data-es="Ver Términos y Condiciones" data-en="View Terms and Conditions">
                        Ver Términos y Condiciones
                    </button>
                </div>

                <p id="spin-message" class="mt-4 text-base font-bold text-light-text/70">
                    <span data-es="¡Gira y gana un premio por tu consumo!" data-en="Spin and win a prize for your order!">¡Gira y gana un premio por tu consumo!</span>
                </p>
                
            </div>
        </section>


        <!-- 7. Modal de Resultado del Premio -->
        <div id="modalResult" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-[100] hidden flex items-center justify-center p-4">
            <div class="bg-dark-bg p-6 rounded-xl shadow-2xl max-w-sm w-full transform opacity-0 scale-95 border-2 border-brand-gold" id="modalResultContent">
                <h3 id="resultTitle" class="text-2xl font-extrabold mb-4 text-center text-brand-green">¡Felicidades!</h3>
                <p class="text-center text-gray-400 mb-4 text-base" data-es="Has ganado:" data-en="You have won:">Has ganado:</p>
                <div id="prizeResult" class="text-center text-3xl font-bold title-font text-brand-gold p-3 bg-gray-800 rounded-lg border border-brand-red"></div>
                <p class="text-sm text-center text-gray-500 mt-4" data-es="Muestra esto y cumple los T&C para canjear tu premio." data-en="Show this and meet T&C to redeem your prize.">Presenta este código al personal para validar tu premio (sujeto a T&C).</p>
                <button onclick="toggleModal('modalResult', false)" class="mt-4 w-full bg-brand-red text-white py-2 rounded-lg font-semibold hover:bg-red-700 transition text-base">Cerrar</button>
            </div>
        </div>

        <!-- 8. Modal de Términos y Condiciones (T&C) -->
        <div id="modalTerms" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-[100] hidden flex items-center justify-center p-4">
            <div class="bg-dark-bg p-6 rounded-xl shadow-2xl max-w-md w-full transform opacity-0 scale-95 border-2 border-brand-red" id="modalTermsContent">
                <h3 class="text-2xl font-bold mb-4 text-brand-gold title-font" data-es="TÉRMINOS Y CONDICIONES" data-en="TERMS AND CONDITIONS">TÉRMINOS Y CONDICIONES</h3>
                
                <p class="mb-4 text-brand-red font-semibold text-base" data-es="**Requisitos Obligatorios para Canje:**" data-en="**Mandatory Requirements for Redemption:**">
                    **Requisitos Obligatorios para Canje:**
                </p>

                <ul class="list-disc list-inside space-y-2 text-gray-300 text-sm ml-4">
                    <li data-es="**Seguir** nuestra página oficial en la red social de su elección." data-en="**Follow** our official page on the social network of your choice."></li>
                    <li data-es="Dar **'Me Gusta'** a nuestra última publicación." data-en="Give **'Like'** to our latest post."></li>
                    <li data-es="Subir una **Historia** a Instagram o Facebook, mencionando nuestra cuenta oficial **(@TuNombreDeNegocio)**." data-en="Upload a **Story** to Instagram or Facebook, mentioning our official account **(@YourBusinessName)**."></li>
                </ul>

                <h4 class="text-lg font-bold mt-6 mb-2 text-brand-green" data-es="Restricciones Adicionales:" data-en="Additional Restrictions:">Restricciones Adicionales:</h4>
                <ul class="list-disc list-inside space-y-1 text-xs text-gray-400 ml-4">
                    <li data-es="El premio es **personal** (uno por mesa/orden) y no es canjeable por dinero." data-en="Prize is **personal** (one per table/order) and not redeemable for cash."></li>
                    <li data-es="Válido únicamente para consumo en el local. No aplica para domicilio." data-en="Valid only for on-site consumption. Does not apply to delivery."></li>
                    <li data-es="Sujeto a la disponibilidad de inventario." data-en="Subject to inventory availability."></li>
                </ul>

                <button onclick="toggleModal('modalTerms', false)" class="mt-6 w-full bg-brand-red text-white py-2 rounded-lg font-semibold hover:bg-red-700 transition text-base" data-es="Entendido" data-en="Understood">Entendido</button>
            </div>
        </div>

        <!-- 9. Modal para Visualización de Imagen del Plato -->
        <div id="image-modal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4" onclick="closeImageModal()">
            <div id="image-modal-backdrop" class="absolute inset-0 bg-dark-bg/95"></div>
            <div class="modal-content relative w-full max-w-sm md:max-w-md bg-dark-bg rounded-2xl shadow-2xl overflow-hidden border-2 border-brand-gold transform scale-100" onclick="event.stopPropagation()">
                <button onclick="closeImageModal()" class="absolute top-3 right-3 z-10 bg-brand-red p-2 rounded-full text-white hover:bg-red-700 transition duration-200">
                    <i class="fas fa-times"></i>
                </button>
                <img id="modal-image" src="" alt="Imagen del Plato" class="w-full h-56 object-cover">
                <div class="p-5 text-center">
                    <h3 id="modal-title" class="text-xl font-black title-font text-brand-gold mb-1"></h3>
                    <p id="modal-description" class="text-base text-gray-400 italic mb-0"></p>
                </div>
            </div>
        </div>

        <!-- 10. Pie de Página con Contacto y Enlaces -->
        <footer class="bg-dark-bg border-t-4 border-brand-gold mt-8 py-6">
            <div class="max-w-7xl mx-auto px-4 text-center">
                <h3 class="text-xl font-black title-font text-brand-red mb-3" data-es="¡HAZ TU PEDIDO YA!" data-en="ORDER NOW!">¡HAZ TU PEDIDO YA!</h3>
                <a href="https://wa.me/message/KNZ4SJGC4PUPJ" target="_blank" 
                   class="inline-flex items-center justify-center space-x-2 bg-brand-green text-white font-extrabold py-2 px-6 rounded-full shadow-lg hover:bg-green-700 cta-button mb-4 text-base">
                    <i class="fab fa-whatsapp text-xl"></i>
                    <span data-es="CHATEA CON NOSOTROS" data-en="CHAT WITH US">CHATEA CON NOSOTROS</span>
                </a>
                <div class="flex justify-center space-x-6 mb-4 text-sm">
                    <a href="#ruleta" class="text-light-text/70 hover:text-brand-gold transition duration-300" data-es="RULETA DE PREMIOS" data-en="PRIZE WHEEL">RULETA DE PREMIOS</a>
                    <button onclick="toggleModal('modalTerms', true)" class="text-light-text/70 hover:text-brand-gold transition duration-300" data-es="TÉRMINOS" data-en="TERMS">TÉRMINOS</button>
                </div>
                <div class="flex justify-center space-x-6 mb-4">
                    <a href="https://www.instagram.com/cielito_lindo_sm/" target="_blank" class="text-light-text hover:text-brand-gold transition duration-300 transform hover:scale-110">
                        <i class="fab fa-instagram text-2xl"></i>
                    </a>
                    <a href="#" target="_blank" class="text-light-text hover:text-brand-gold transition duration-300 transform hover:scale-110">
                        <i class="fab fa-facebook text-2xl"></i>
                    </a>
                    <a href="#" target="_blank" class="text-light-text hover:text-brand-gold transition duration-300 transform hover:scale-110">
                        <i class="fab fa-tiktok text-2xl"></i>
                    </a>
                </div>
                <p class="text-xs text-gray-500 mt-4">&copy; 2024 CIELITO LINDO. Sabor y Fiesta.</p>
            </div>
        </footer>

    </main>
</body>
</html>
